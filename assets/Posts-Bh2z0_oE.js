var ae=Object.defineProperty,ie=Object.defineProperties;var oe=Object.getOwnPropertyDescriptors;var X=Object.getOwnPropertySymbols;var le=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable;var z=(n,s,a)=>s in n?ae(n,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[s]=a,b=(n,s)=>{for(var a in s||(s={}))le.call(s,a)&&z(n,a,s[a]);if(X)for(var a of X(s))ue.call(s,a)&&z(n,a,s[a]);return n},N=(n,s)=>ie(n,oe(s));import{j as c,M as O,L as ce}from"./index-9-TbF7k1.js";import{R as h,e as M,b as p,f as pe}from"./react-vendor-CjwK12p3.js";import{M as $}from"./MyInput-CbHAhVcT.js";import{u as de,P as fe}from"./useFetching-D7-afM0X.js";import"./axios-vendor-bIC8cyVI.js";function T(){return T=Object.assign?Object.assign.bind():function(n){for(var s=1;s<arguments.length;s++){var a=arguments[s];for(var e in a)({}).hasOwnProperty.call(a,e)&&(n[e]=a[e])}return n},T.apply(null,arguments)}function V(n,s){if(n==null)return{};var a={};for(var e in n)if({}.hasOwnProperty.call(n,e)){if(s.indexOf(e)!==-1)continue;a[e]=n[e]}return a}function I(n,s){return I=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,e){return a.__proto__=e,a},I(n,s)}function F(n,s){n.prototype=Object.create(s.prototype),n.prototype.constructor=n,I(n,s)}function he(n,s){return n.classList?!!s&&n.classList.contains(s):(" "+(n.className.baseVal||n.className)+" ").indexOf(" "+s+" ")!==-1}function ve(n,s){n.classList?n.classList.add(s):he(n,s)||(typeof n.className=="string"?n.className=n.className+" "+s:n.setAttribute("class",(n.className&&n.className.baseVal||"")+" "+s))}function H(n,s){return n.replace(new RegExp("(^|\\s)"+s+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function me(n,s){n.classList?n.classList.remove(s):typeof n.className=="string"?n.className=H(n.className,s):n.setAttribute("class",H(n.className&&n.className.baseVal||"",s))}const J={disabled:!1},R=h.createContext(null);var Q=function(s){return s.scrollTop},_="unmounted",x="exited",g="entering",j="entered",w="exiting",E=(function(n){F(s,n);function s(e,t){var r;r=n.call(this,e,t)||this;var i=t,o=i&&!i.isMounting?e.enter:e.appear,l;return r.appearStatus=null,e.in?o?(l=x,r.appearStatus=g):l=j:e.unmountOnExit||e.mountOnEnter?l=_:l=x,r.state={status:l},r.nextCallback=null,r}s.getDerivedStateFromProps=function(t,r){var i=t.in;return i&&r.status===_?{status:x}:null};var a=s.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(t){var r=null;if(t!==this.props){var i=this.state.status;this.props.in?i!==g&&i!==j&&(r=g):(i===g||i===j)&&(r=w)}this.updateStatus(!1,r)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var t=this.props.timeout,r,i,o;return r=i=o=t,t!=null&&typeof t!="number"&&(r=t.exit,i=t.enter,o=t.appear!==void 0?t.appear:i),{exit:r,enter:i,appear:o}},a.updateStatus=function(t,r){if(t===void 0&&(t=!1),r!==null)if(this.cancelNextCallback(),r===g){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:M.findDOMNode(this);i&&Q(i)}this.performEnter(t)}else this.performExit();else this.props.unmountOnExit&&this.state.status===x&&this.setState({status:_})},a.performEnter=function(t){var r=this,i=this.props.enter,o=this.context?this.context.isMounting:t,l=this.props.nodeRef?[o]:[M.findDOMNode(this),o],u=l[0],d=l[1],f=this.getTimeouts(),v=o?f.appear:f.enter;if(!t&&!i||J.disabled){this.safeSetState({status:j},function(){r.props.onEntered(u)});return}this.props.onEnter(u,d),this.safeSetState({status:g},function(){r.props.onEntering(u,d),r.onTransitionEnd(v,function(){r.safeSetState({status:j},function(){r.props.onEntered(u,d)})})})},a.performExit=function(){var t=this,r=this.props.exit,i=this.getTimeouts(),o=this.props.nodeRef?void 0:M.findDOMNode(this);if(!r||J.disabled){this.safeSetState({status:x},function(){t.props.onExited(o)});return}this.props.onExit(o),this.safeSetState({status:w},function(){t.props.onExiting(o),t.onTransitionEnd(i.exit,function(){t.safeSetState({status:x},function(){t.props.onExited(o)})})})},a.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(t,r){r=this.setNextCallback(r),this.setState(t,r)},a.setNextCallback=function(t){var r=this,i=!0;return this.nextCallback=function(o){i&&(i=!1,r.nextCallback=null,t(o))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},a.onTransitionEnd=function(t,r){this.setNextCallback(r);var i=this.props.nodeRef?this.props.nodeRef.current:M.findDOMNode(this),o=t==null&&!this.props.addEndListener;if(!i||o){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],u=l[0],d=l[1];this.props.addEndListener(u,d)}t!=null&&setTimeout(this.nextCallback,t)},a.render=function(){var t=this.state.status;if(t===_)return null;var r=this.props,i=r.children;r.in,r.mountOnEnter,r.unmountOnExit,r.appear,r.enter,r.exit,r.timeout,r.addEndListener,r.onEnter,r.onEntering,r.onEntered,r.onExit,r.onExiting,r.onExited,r.nodeRef;var o=V(r,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return h.createElement(R.Provider,{value:null},typeof i=="function"?i(t,o):h.cloneElement(h.Children.only(i),o))},s})(h.Component);E.contextType=R;E.propTypes={};function P(){}E.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:P,onEntering:P,onEntered:P,onExit:P,onExiting:P,onExited:P};E.UNMOUNTED=_;E.EXITED=x;E.ENTERING=g;E.ENTERED=j;E.EXITING=w;var Ee=function(s,a){return s&&a&&a.split(" ").forEach(function(e){return ve(s,e)})},D=function(s,a){return s&&a&&a.split(" ").forEach(function(e){return me(s,e)})},U=(function(n){F(s,n);function s(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e=n.call.apply(n,[this].concat(r))||this,e.appliedClasses={appear:{},enter:{},exit:{}},e.onEnter=function(o,l){var u=e.resolveArguments(o,l),d=u[0],f=u[1];e.removeClasses(d,"exit"),e.addClass(d,f?"appear":"enter","base"),e.props.onEnter&&e.props.onEnter(o,l)},e.onEntering=function(o,l){var u=e.resolveArguments(o,l),d=u[0],f=u[1],v=f?"appear":"enter";e.addClass(d,v,"active"),e.props.onEntering&&e.props.onEntering(o,l)},e.onEntered=function(o,l){var u=e.resolveArguments(o,l),d=u[0],f=u[1],v=f?"appear":"enter";e.removeClasses(d,v),e.addClass(d,v,"done"),e.props.onEntered&&e.props.onEntered(o,l)},e.onExit=function(o){var l=e.resolveArguments(o),u=l[0];e.removeClasses(u,"appear"),e.removeClasses(u,"enter"),e.addClass(u,"exit","base"),e.props.onExit&&e.props.onExit(o)},e.onExiting=function(o){var l=e.resolveArguments(o),u=l[0];e.addClass(u,"exit","active"),e.props.onExiting&&e.props.onExiting(o)},e.onExited=function(o){var l=e.resolveArguments(o),u=l[0];e.removeClasses(u,"exit"),e.addClass(u,"exit","done"),e.props.onExited&&e.props.onExited(o)},e.resolveArguments=function(o,l){return e.props.nodeRef?[e.props.nodeRef.current,o]:[o,l]},e.getClassNames=function(o){var l=e.props.classNames,u=typeof l=="string",d=u&&l?l+"-":"",f=u?""+d+o:l[o],v=u?f+"-active":l[o+"Active"],y=u?f+"-done":l[o+"Done"];return{baseClassName:f,activeClassName:v,doneClassName:y}},e}var a=s.prototype;return a.addClass=function(t,r,i){var o=this.getClassNames(r)[i+"ClassName"],l=this.getClassNames("enter"),u=l.doneClassName;r==="appear"&&i==="done"&&u&&(o+=" "+u),i==="active"&&t&&Q(t),o&&(this.appliedClasses[r][i]=o,Ee(t,o))},a.removeClasses=function(t,r){var i=this.appliedClasses[r],o=i.base,l=i.active,u=i.done;this.appliedClasses[r]={},o&&D(t,o),l&&D(t,l),u&&D(t,u)},a.render=function(){var t=this.props;t.classNames;var r=V(t,["classNames"]);return h.createElement(E,T({},r,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},s})(h.Component);U.defaultProps={classNames:""};U.propTypes={};function xe(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function W(n,s){var a=function(r){return s&&p.isValidElement(r)?s(r):r},e=Object.create(null);return n&&p.Children.map(n,function(t){return t}).forEach(function(t){e[t.key]=a(t)}),e}function ge(n,s){n=n||{},s=s||{};function a(d){return d in s?s[d]:n[d]}var e=Object.create(null),t=[];for(var r in n)r in s?t.length&&(e[r]=t,t=[]):t.push(r);var i,o={};for(var l in s){if(e[l])for(i=0;i<e[l].length;i++){var u=e[l][i];o[e[l][i]]=a(u)}o[l]=a(l)}for(i=0;i<t.length;i++)o[t[i]]=a(t[i]);return o}function C(n,s,a){return a[s]!=null?a[s]:n.props[s]}function Ce(n,s){return W(n.children,function(a){return p.cloneElement(a,{onExited:s.bind(null,a),in:!0,appear:C(a,"appear",n),enter:C(a,"enter",n),exit:C(a,"exit",n)})})}function be(n,s,a){var e=W(n.children),t=ge(s,e);return Object.keys(t).forEach(function(r){var i=t[r];if(p.isValidElement(i)){var o=r in s,l=r in e,u=s[r],d=p.isValidElement(u)&&!u.props.in;l&&(!o||d)?t[r]=p.cloneElement(i,{onExited:a.bind(null,i),in:!0,exit:C(i,"exit",n),enter:C(i,"enter",n)}):!l&&o&&!d?t[r]=p.cloneElement(i,{in:!1}):l&&o&&p.isValidElement(u)&&(t[r]=p.cloneElement(i,{onExited:a.bind(null,i),in:u.props.in,exit:C(i,"exit",n),enter:C(i,"enter",n)}))}}),t}var Ne=Object.values||function(n){return Object.keys(n).map(function(s){return n[s]})},Pe={component:"div",childFactory:function(s){return s}},G=(function(n){F(s,n);function s(e,t){var r;r=n.call(this,e,t)||this;var i=r.handleExited.bind(xe(r));return r.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},r}var a=s.prototype;return a.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},a.componentWillUnmount=function(){this.mounted=!1},s.getDerivedStateFromProps=function(t,r){var i=r.children,o=r.handleExited,l=r.firstRender;return{children:l?Ce(t,o):be(t,i,o),firstRender:!1}},a.handleExited=function(t,r){var i=W(this.props.children);t.key in i||(t.props.onExited&&t.props.onExited(r),this.mounted&&this.setState(function(o){var l=T({},o.children);return delete l[t.key],{children:l}}))},a.render=function(){var t=this.props,r=t.component,i=t.childFactory,o=V(t,["component","childFactory"]),l=this.state.contextValue,u=Ne(this.state.children).map(i);return delete o.appear,delete o.enter,delete o.exit,r===null?h.createElement(R.Provider,{value:l},u):h.createElement(R.Provider,{value:l},h.createElement(r,o,u))},s})(h.Component);G.propTypes={};G.defaultProps=Pe;const je=p.forwardRef((n,s)=>{const a=pe(),{post:e,remove:t}=n;return c.jsxs("div",{ref:s,className:"post",children:[c.jsxs("div",{className:"post__content",children:[c.jsxs("strong",{children:[e.id,". ",e.title]}),c.jsx("div",{children:e.body})]}),c.jsxs("div",{className:"post__btns",children:[c.jsx(O,{onClick:()=>a(`${e.id}`),children:"Open"}),c.jsx(O,{onClick:()=>t(e),children:"Delete"})]})]})}),Se=p.memo(je),_e="_title_1reb9_1",ye={title:_e},Me=({posts:n,title:s,remove:a})=>{const e=p.useRef(new Map);return c.jsxs("div",{children:[c.jsx("h1",{className:ye.title,children:s}),c.jsx(G,{children:n.map((t,r)=>{let i=e.current.get(t.id);return i||(i=p.createRef(),e.current.set(t.id,i)),c.jsx(U,{timeout:500,classNames:"post",nodeRef:i,children:c.jsx(Se,{ref:i,remove:a,post:t,number:r+1})},t.id)})})]})},Oe=p.memo(Me),Te="_topButton_rfqkm_1",Re="_lastElement_rfqkm_5",ke="_loaderWrap_rfqkm_10",A={topButton:Te,lastElement:Re,loaderWrap:ke},De=({create:n})=>{const[s,a]=p.useState({title:"",body:""}),e=t=>{t.preventDefault();const r=N(b({},s),{id:Date.now()});n(r),a({title:"",body:""})};return c.jsxs("form",{children:[c.jsx($,{value:s.title,onInput:t=>a(N(b({},s),{title:t.target.value})),type:"text",placeholder:"Post name"}),c.jsx($,{value:s.body,onChange:t=>a(N(b({},s),{body:t.target.value})),type:"text",placeholder:"Post description"}),c.jsx(O,{onClick:e,children:"Create post"})]})},Ae=({options:n,defaultValue:s,value:a,onChange:e})=>c.jsxs("select",{value:a,onChange:t=>e(t.target.value),children:[c.jsx("option",{disabled:!0,value:"",children:s}),n.map(t=>c.jsx("option",{value:t.value,children:t.name},t.value))]}),Y=p.memo(Ae),Le=({filter:n,setFilter:s})=>c.jsxs("div",{children:[c.jsx($,{placeholder:"Search",value:n.query,onChange:a=>s(N(b({},n),{query:a.target.value}))}),c.jsx(Y,{value:n.sort,onChange:a=>s(N(b({},n),{sort:a})),defaultValue:"Sorting",options:[{value:"title",name:"by name"},{value:"body",name:"by value"}]})]}),$e="_myModal_133my_1",Ie="_myModalContent_133my_11",we="_active_133my_18",L={myModal:$e,myModalContent:Ie,active:we},Ve=({children:n,visible:s,setVisible:a})=>{const e=[L.myModal];return s&&e.push(L.active),c.jsx("div",{className:e.join(" "),onClick:()=>a(!1),children:c.jsx("div",{className:L.myModalContent,onClick:t=>t.stopPropagation(),children:n})})},Fe=(n,s)=>p.useMemo(()=>s?[...n].sort((e,t)=>e[s].localeCompare(t[s])):n,[s,n]),Ue=(n,s,a)=>{const e=Fe(n,s);return p.useMemo(()=>e.filter(r=>r.title.toLocaleLowerCase().includes(a)),[a,e])},We=(n,s)=>Math.ceil(n/s),Ge=n=>{const s=[];for(let a=0;a<n;a++)s.push(a+1);return s},qe=({totalPages:n,page:s,changePage:a})=>{const e=Ge(n);return c.jsx("div",{className:"page__wrapper",children:e.map(t=>c.jsx("span",{onClick:()=>a(t),className:s===t?"page page__current":"page",children:t},t))})},Be=p.memo(qe),Xe=(n,s,a,e)=>{const t=p.useRef();p.useEffect(()=>{if(a)return;t.current&&t.current.disconnect();const r=(i,o)=>{i[0].isIntersecting&&s&&e()};t.current=new IntersectionObserver(r),t.current.observe(n.current)},[a])};function Ke(){const[n,s]=p.useState([]),[a,e]=p.useState({sort:"",query:""}),[t,r]=p.useState(!1),[i,o]=p.useState(0),[l,u]=p.useState(10),[d,f]=p.useState(1),v=Ue(n,a.sort,a.query),y=p.useRef(),[Z,q,B]=de(async()=>{const m=await fe.getAll(l,d);s(k=>[...k,...m.data]);const S=m.headers["x-total-count"];o(We(S,l))});Xe(y,d<i,q,()=>{f(d+1)}),p.useEffect(()=>{Z(l,d)},[d,l]);const K=p.useCallback(()=>r(!0),[]),ee=p.useCallback(m=>{s(S=>[...S,m]),r(!1)},[]),te=p.useCallback(m=>{s(S=>S.filter(k=>k.id!==m.id))},[]),ne=p.useCallback(m=>f(m),[]),se=p.useCallback(m=>u(m),[]),re=p.useMemo(()=>[{value:5,name:"5"},{value:10,name:"10"},{value:25,name:"25"},{value:-1,name:"All posts"}],[]);return c.jsxs("div",{className:"App",children:[c.jsx("div",{className:A.topButton,children:c.jsx(O,{onClick:K,children:"Create user"})}),c.jsx(Ve,{visible:t,setVisible:r,children:c.jsx(De,{create:ee})}),c.jsx(Le,{filter:a,setFilter:e}),B&&c.jsxs("h1",{children:["Error $",B]}),c.jsx(Y,{value:l,onChange:se,defaultValue:"Posts quantity",options:re}),c.jsx(Oe,{remove:te,posts:v,title:"javascript posts"}),c.jsx("div",{ref:y,className:A.lastElement}),q&&c.jsx("div",{className:A.loaderWrap,children:c.jsx(ce,{})}),c.jsx(Be,{totalPages:i,page:d,changePage:ne})]})}export{Ke as default};
